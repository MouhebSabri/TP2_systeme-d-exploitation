#include <stdio.h>
#include <unistd.h>

#include <sys/wait.h>
#include <stdlib.h>

void creerChaine (int n) {
    printf("[CREER CHAINE] \n");
    for(int i=0; i<n-1; i++){
		int id = fork();
        if (id>0){
			break;
		}
		printf("pid:%d ppid:%d %d\n", getpid(), getppid(), i);  
		
	}
    wait(NULL);
}


void binaryTree (int n){
    printf("[CREER ARBRE BINAIRE] \n");
    int id1=0;
    int id2=0;
    for(int i=0; i<n; i++){
        id1=fork();
        if (id1!=0){
            id2=fork();
            if (id2 != 0){
                break;
            }
        }
        printf("pid:%d ppid:%d id1:%d id2:%d\n", getpid(), getppid(), id1, id2);  
        }
    wait(NULL);
}


int zombie(){
    printf("[ZOMBIE] \n");
    int id=fork();
    if (id==0){
        exit(1);
    }
    printf("[Begin sleep] \n");
    sleep(10);
    printf("[End sleep] \n");
    wait(NULL);
    
    return 0;
}

void Question4(){
    printf("[BEGIN QUESTION4] \n");
    int id1=fork();
    int toto;
    if(id1==0){
        exit(5);
    }
    wait(&toto);
    printf("toto : %d \n", WEXITSTATUS(toto));
    printf("[END QUESTION4] \n");
}

int main(){
    creerChaine(6);
    binaryTree(3);
    zombie();
    Question4();
    return 0;
}

